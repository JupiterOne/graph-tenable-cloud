import { MappedRelationshipFromIntegration } from "@jupiterone/jupiter-managed-integration-sdk";

/**
 * A relationship between a scan and an identified vulnerability.
 *
 * A mapped relationship is used because there will be many scans pointing to
 * the same vulnerability, perhaps from different integration instances.
 * Scan-specific information (i.e. number of instances of the vulnerability
 * found by the scan) about the vulnerability is placed on the relationship.
 */
export interface ScanVulnerabilityRelationship
  extends MappedRelationshipFromIntegration {
  scanId: number;
  scanUuid: string;
  count: number;
}

export const SCAN_VULNERABILITY_RELATIONSHIP_TYPE =
  "tenable_scan_identified_vulnerability";
export const SCAN_VULNERABILITY_RELATIONSHIP_CLASS = "IDENTIFIED";
