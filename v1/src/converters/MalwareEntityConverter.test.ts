import { createMalwareEntities } from "./MalwareEntityConverter";

test("convert container vulnerability entity", () => {
  const data = {
    "sha256:c42a932fda50763cb2a0169dd853f071a37629cfa4a477b81b4ee87c2b0bb3dc": [
      {
        infectedFile: "string",
        fileTypeDescriptor: "string",
        md5: "malwareMd5",
        sha256: "string",
      },
    ],
  };

  const entities = createMalwareEntities(data as any);

  expect(entities).toEqual([
    {
      _class: "Finding",
      _key: "tenable_container_malware_malwareMd5",
      _type: "tenable_container_malware",
      _rawData: [
        {
          name: "default",
          rawData: {
            infectedFile: "string",
            fileTypeDescriptor: "string",
            md5: "malwareMd5",
            sha256: "string",
          },
        },
      ],
      fileTypeDescriptor: "string",
      infectedFile: "string",
      md5: "malwareMd5",
      sha256: "string",
    },
  ]);
});
